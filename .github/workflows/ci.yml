# ========================================
# SIMPLE CI PIPELINE - Learning Version
# ========================================
# What: Automated checks on every push
# Why: Catch bugs before they reach production
# When: Runs automatically on git push

name:  CI

on:
  push:
    branches: [ main, develop, feature/* ]
  pull_request:
    branches: [ main, develop, feature/* ]


jobs:
  
  check-python:
    name: Check Python Code
    runs-on: ubuntu-latest
    
    steps:
      # Step 1: Get code from GitHub
      - name: Get Code
        uses: actions/checkout@v4
      
      # Step 2: Install Python
      - name: Install Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      
      # Step 3: Install packages
      - name: Install Packages
        run: |
          pip install -r requirements.txt
      
      # Step 5: Run tests
      - name: Run Tests
        run: |
          pip install pytest
          pytest tests/ --verbose || echo "No tests yet"
  

  build-image:
    name: Build Docker Image
    runs-on: ubuntu-latest
    
    steps:
      - name: Get Code
        uses: actions/checkout@v4 
      - name: Build Backend
        run: |
          docker build -t connecthub-backend .
          echo "Image built successfully"
      
      - name: Test Image Runs
        run: |
          echo "Testing: Can container start?"
          docker run --rm connecthub-backend python --version
          echo "Container can execute commands"
      
      - name: Verify Image Structure
        run: |
          docker run --rm connecthub-backend ls -la /app
      




